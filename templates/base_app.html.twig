<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Vault.gg{% endblock %}</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%20512%20512%27%3E%3Cpath%20d%3D%27M380%20160H132c-45%200-70%2030-70%2070v70c0%2050%2030%2080%2060%2080s50-30%2050-70v-20h168v20c0%2040%2020%2070%2050%2070s60-30%2060-80v-70c0-40-25-70-70-70z%27%20fill%3D%27none%27%20stroke%3D%27%237970FF%27%20stroke-width%3D%2724%27%20stroke-linejoin%3D%27round%27%2F%3E%3C!--%20Stick%20Gauche%20(Haut)%20--%3E%3Ccircle%20cx%3D%27145%27%20cy%3D%27235%27%20r%3D%2728%27%20stroke%3D%27%237970FF%27%20stroke-width%3D%2712%27%20fill%3D%27none%27%2F%3E%3C!--%20Stick%20Droit%20(Bas)%20--%3E%3Ccircle%20cx%3D%27300%27%20cy%3D%27305%27%20r%3D%2728%27%20stroke%3D%27%237970FF%27%20stroke-width%3D%2712%27%20fill%3D%27none%27%2F%3E%3C!--%20Boutons%20ABXY%20--%3E%3Ccircle%20cx%3D%27375%27%20cy%3D%27220%27%20r%3D%2712%27%20fill%3D%27%237970FF%27%2F%3E%3Ccircle%20cx%3D%27400%27%20cy%3D%27245%27%20r%3D%2712%27%20fill%3D%27%237970FF%27%2F%3E%3Ccircle%20cx%3D%27375%27%20cy%3D%27270%27%20r%3D%2712%27%20fill%3D%27%237970FF%27%2F%3E%3Ccircle%20cx%3D%27350%27%20cy%3D%27245%27%20r%3D%2712%27%20fill%3D%27%237970FF%27%2F%3E%3C!--%20D-Pad%20--%3E%3Cpath%20d%3D%27M210%20285v40M190%20305h40%27%20stroke%3D%27%237970FF%27%20stroke-width%3D%2714%27%20stroke-linecap%3D%27round%27%2F%3E%3C%2Fsvg%3E">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ asset('css/main.css') }}?v=2">
    
    {% block stylesheets %}{% endblock %}
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        vault: {
                            primary: '#6366F1',
                            secondary: '#8B5CF6',
                            success: '#10B981',
                            progress: '#F59E0B',
                            backlog: '#6B7280',
                        }
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-gradient-to-br from-slate-900 to-slate-800 text-slate-100 min-h-screen transition-colors duration-300 flex flex-col">
    
    <!-- NAVBAR TOP -->
    <nav class="fixed top-0 left-0 right-0 h-[70px] glass backdrop-blur-xl z-50 px-4 md:px-6 flex items-center justify-between">
        
        <!-- Logo -->
        <a href="{{ path('app_home') }}" class="flex items-center gap-2 md:gap-3 no-underline group">
            <i data-lucide="gamepad-2" class="w-6 h-6 md:w-8 md:h-8 text-indigo-500 group-hover:scale-110 transition-transform"></i>
            <span class="text-xl md:text-2xl font-black gradient-text">Vault.gg</span>
        </a>
        
        <!-- Actions -->
        <div class="flex items-center gap-3 md:gap-4">
            
            <!-- Theme Toggle -->
            <button 
                id="theme-toggle" 
                class="w-10 h-10 rounded-full glass flex items-center justify-center hover:bg-indigo-500/20 transition-all cursor-pointer hover:scale-110"
                aria-label="Toggle theme">
                <i data-lucide="sun" id="theme-icon" class="w-5 h-5 text-indigo-500"></i>
            </button>
            
            <!-- User Avatar -->
            {% if app.user %}
                <a href="{{ path('app_profile') }}" class="no-underline group">
                    {% if app.user.avatar %}
                        <img 
                            src="{{ asset('uploads/avatars/' ~ app.user.avatar) }}" 
                            alt="Avatar {{ app.user.username }}" 
                            class="w-10 h-10 rounded-full object-cover border-2 border-indigo-500 group-hover:border-violet-500 transition-colors"
                        >
                    {% else %}
                        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-violet-500 flex items-center justify-center text-white font-bold group-hover:scale-110 transition-transform">
                            {{ app.user.username|first|upper }}
                        </div>
                    {% endif %}
                </a>
            {% endif %}
            
        </div>
    </nav>

    <!-- MAIN CONTAINER (3 COLUMNS DESKTOP / 1 COLUMN MOBILE) -->
    <div class="mt-[70px] mb-0 lg:mb-0 pb-20 lg:pb-0 flex gap-6 p-4 md:p-6 min-h-[calc(100vh-70px)] max-w-[2000px] mx-auto w-full flex-1">
        
        <!-- SIDEBAR LEFT (Desktop only) -->
        <aside class="w-64 glass rounded-2xl p-6 h-fit sticky top-24 hidden lg:block">
            
            <h3 class="text-lg font-bold mb-5 flex items-center gap-2">
                <i data-lucide="menu" class="w-5 h-5"></i>
                Menu
            </h3>
            
            <nav class="flex flex-col gap-2">
                
                <a 
                    href="{{ path('app_home') }}" 
                    class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-indigo-500/10 hover:text-indigo-400 transition-all no-underline {% if app.request.get('_route') == 'app_home' %}bg-indigo-500/20 text-indigo-400{% endif %}"
                >
                    <i data-lucide="library" class="w-5 h-5"></i>
                    <span>Ma BibliothÃ¨que</span>
                </a>
                
                <a 
                    href="{{ path('app_search') }}" 
                    class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-indigo-500/10 hover:text-indigo-400 transition-all no-underline {% if app.request.get('_route') == 'app_search' %}bg-indigo-500/20 text-indigo-400{% endif %}"
                >
                    <i data-lucide="search" class="w-5 h-5"></i>
                    <span>Rechercher</span>
                </a>
                
                <a 
                    href="{{ path('app_favorites') }}" 
                    class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-indigo-500/10 hover:text-indigo-400 transition-all no-underline {% if app.request.get('_route') == 'app_favorites' %}bg-indigo-500/20 text-indigo-400{% endif %}"
                >
                    <i data-lucide="heart" class="w-5 h-5"></i>
                    <span>Favoris</span>
                </a>
                
                <a 
                    href="{{ path('app_statistics') }}" 
                    class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-indigo-500/10 hover:text-indigo-400 transition-all no-underline {% if app.request.get('_route') == 'app_statistics' %}bg-indigo-500/20 text-indigo-400{% endif %}"
                >
                    <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
                    <span>Statistiques</span>
                </a>
                
                {% if is_granted('ROLE_ADMIN') %}
                    <a 
                        href="{{ path('app_admin_dashboard') }}" 
                        class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-orange-500/10 hover:text-orange-400 transition-all no-underline {% if app.request.get('_route') starts with 'app_admin' %}bg-orange-500/20 text-orange-400{% endif %}"
                    >
                        <i data-lucide="shield" class="w-5 h-5"></i>
                        <span>Admin</span>
                        <span class="ml-auto text-xs font-bold bg-orange-500/20 text-orange-400 px-2 py-0.5 rounded">ðŸ‘‘</span>
                    </a>
                {% endif %}
                
                <hr class="my-2 border-slate-700">
                
                <a 
                    href="{{ path('app_logout') }}" 
                    class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-red-500/10 hover:text-red-400 transition-all no-underline"
                >
                    <i data-lucide="log-out" class="w-5 h-5"></i>
                    <span>DÃ©connexion</span>
                </a>
                
            </nav>
            
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-1 min-w-0">
            {% block content %}{% endblock %}
        </main>

        <!-- STATS PANEL RIGHT (Desktop XL only) -->
        <aside class="w-80 glass rounded-2xl p-6 h-fit sticky top-24 hidden xl:block">
            
            <h3 class="text-lg font-bold mb-5 flex items-center gap-2">
                <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
                Statistiques
            </h3>
            
            {% if stats is defined %}
                
                <div class="space-y-4">
                    
                    <div class="pb-4 border-b border-slate-700">
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="library" class="w-3.5 h-3.5"></i>
                            Total jeux
                        </div>
                        <div class="text-3xl font-black">{{ stats.total }}</div>
                    </div>
                    
                    <div class="pb-4 border-b border-slate-700">
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="play-circle" class="w-3.5 h-3.5"></i>
                            En cours
                        </div>
                        <div class="text-3xl font-black text-amber-500">{{ stats.in_progress }}</div>
                    </div>
                    
                    <div class="pb-4 border-b border-slate-700">
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="check-circle" class="w-3.5 h-3.5"></i>
                            TerminÃ©s
                        </div>
                        <div class="text-3xl font-black text-emerald-500">{{ stats.completed }}</div>
                    </div>
                    
                    <div>
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="clock" class="w-3.5 h-3.5"></i>
                            Ã€ commencer
                        </div>
                        <div class="text-3xl font-black text-slate-400">{{ stats.backlog }}</div>
                    </div>
                    
                </div>
                
            {% else %}
                
                <div class="space-y-4">
                    
                    <div class="pb-4 border-b border-slate-700">
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="library" class="w-3.5 h-3.5"></i>
                            Total jeux
                        </div>
                        <div class="text-3xl font-black">0</div>
                    </div>
                    
                    <div class="pb-4 border-b border-slate-700">
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="play-circle" class="w-3.5 h-3.5"></i>
                            En cours
                        </div>
                        <div class="text-3xl font-black text-amber-500">0</div>
                    </div>
                    
                    <div class="pb-4 border-b border-slate-700">
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="check-circle" class="w-3.5 h-3.5"></i>
                            TerminÃ©s
                        </div>
                        <div class="text-3xl font-black text-emerald-500">0</div>
                    </div>
                    
                    <div>
                        <div class="flex items-center gap-2 text-xs text-slate-400 uppercase mb-1">
                            <i data-lucide="clock" class="w-3.5 h-3.5"></i>
                            Backlog
                        </div>
                        <div class="text-3xl font-black text-slate-400">0</div>
                    </div>
                    
                </div>
                
            {% endif %}
            
        </aside>

    </div>

    <!-- FOOTER (Desktop only) -->
    <footer class="mt-auto py-6 px-4 text-center border-t border-slate-700/50 hidden lg:block">
        <div class="flex items-center justify-center gap-6 text-sm text-slate-400">
            <span>Â© {{ "now"|date("Y") }} Vault.gg â€” DÃ©veloppÃ© par Arnaud C.</span>
            <span class="text-slate-600">|</span>
            <a 
                href="{{ path('app_legal_mentions') }}" 
                class="hover:text-indigo-400 transition-colors no-underline"
            >
                Mentions LÃ©gales
            </a>
        </div>
    </footer>

    <!-- BOTTOM NAVIGATION (Mobile & Tablet only) -->
    <nav class="fixed bottom-0 left-0 right-0 h-16 glass backdrop-blur-xl z-50 flex items-center justify-around px-2 lg:hidden border-t border-slate-700/50">
        
        <a 
            href="{{ path('app_home') }}" 
            class="flex flex-col items-center gap-0.5 text-slate-400 hover:text-indigo-400 transition-colors no-underline {% if app.request.get('_route') == 'app_home' %}text-indigo-400{% endif %} flex-1"
        >
            <i data-lucide="library" class="w-5 h-5"></i>
            <span class="text-[10px] font-medium">Biblio</span>
        </a>
        
        <a 
            href="{{ path('app_search') }}" 
            class="flex flex-col items-center gap-0.5 text-slate-400 hover:text-indigo-400 transition-colors no-underline {% if app.request.get('_route') == 'app_search' %}text-indigo-400{% endif %} flex-1"
        >
            <i data-lucide="search" class="w-5 h-5"></i>
            <span class="text-[10px] font-medium">Chercher</span>
        </a>
        
        <a 
            href="{{ path('app_favorites') }}" 
            class="flex flex-col items-center gap-0.5 text-slate-400 hover:text-indigo-400 transition-colors no-underline {% if app.request.get('_route') == 'app_favorites' %}text-indigo-400{% endif %} flex-1"
        >
            <i data-lucide="heart" class="w-5 h-5"></i>
            <span class="text-[10px] font-medium">Favoris</span>
        </a>
        
        <a 
            href="{{ path('app_statistics') }}" 
            class="flex flex-col items-center gap-0.5 text-slate-400 hover:text-indigo-400 transition-colors no-underline {% if app.request.get('_route') == 'app_statistics' %}text-indigo-400{% endif %} flex-1"
        >
            <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
            <span class="text-[10px] font-medium">Stats</span>
        </a>
        
        <a 
            href="{{ path('app_legal_mentions') }}" 
            class="flex flex-col items-center gap-0.5 text-slate-400 hover:text-indigo-400 transition-colors no-underline {% if app.request.get('_route') == 'app_legal_mentions' %}text-indigo-400{% endif %} flex-1"
        >
            <i data-lucide="file-text" class="w-5 h-5"></i>
            <span class="text-[10px] font-medium">LÃ©gal</span>
        </a>
        
    </nav>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        // Initialiser Lucide Icons immÃ©diatement
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
            console.log(" Lucide Icons initialisÃ©s");
        }
    </script>

    {% block javascripts %}
    <!-- Theme Toggle Script -->
    <script src="{{ asset('js/theme-toggle.js') }}?v=2"></script>

    <!-- Alerts auto dismiss -->
    <script src="{{ asset('js/alerts.js') }}?v=1"></script>

    <!-- Search Loader -->
    <script src="{{ asset('js/search-loader.js') }}?v=1"></script>
    {% endblock %}


</body>
</html>