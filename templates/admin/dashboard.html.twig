{% extends 'base_app.html.twig' %}

{% block title %}Admin Dashboard - Vault.gg{% endblock %}

{% block content %}

<!-- Messages flash -->
{% for label, messages in app.flashes %}
    {% for message in messages %}
        <div class="p-4 rounded-lg mb-4 
            {% if label == 'success' %}bg-green-500/20 border border-green-500/30 text-green-400{% endif %}
            {% if label == 'error' %}bg-red-500/20 border border-red-500/30 text-red-400{% endif %}">
            {{ message }}
        </div>
    {% endfor %}
{% endfor %}

<!-- En-tête -->
<div class="mb-6">
    <h1 class="text-3xl font-black mb-2 flex items-center gap-3">
        <i data-lucide="shield" class="w-9 h-9 text-amber-500"></i>
        Admin Dashboard
    </h1>
    <p class="text-slate-400">Statistiques et gestion de Vault.gg</p>
</div>

<!-- Statistiques globales -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
    <!-- Total utilisateurs -->
    <div class="glass p-6 text-center">
        <div class="w-14 h-14 bg-indigo-500/20 rounded-xl flex items-center justify-center mx-auto mb-4">
            <i data-lucide="users" class="w-7 h-7 text-indigo-500"></i>
        </div>
        <div class="text-4xl font-black text-slate-100 mb-1">{{ totalUsers }}</div>
        <div class="text-xs text-slate-400 uppercase font-semibold">Utilisateurs</div>
    </div>

    <!-- Total jeux uniques -->
    <div class="glass p-6 text-center">
        <div class="w-14 h-14 bg-violet-500/20 rounded-xl flex items-center justify-center mx-auto mb-4">
            <i data-lucide="gamepad-2" class="w-7 h-7 text-violet-500"></i>
        </div>
        <div class="text-4xl font-black text-slate-100 mb-1">{{ totalGames }}</div>
        <div class="text-xs text-slate-400 uppercase font-semibold">Jeux uniques</div>
    </div>

    <!-- Total entrées -->
    <div class="glass p-6 text-center">
        <div class="w-14 h-14 bg-green-500/20 rounded-xl flex items-center justify-center mx-auto mb-4">
            <i data-lucide="library" class="w-7 h-7 text-green-500"></i>
        </div>
        <div class="text-4xl font-black text-slate-100 mb-1">{{ totalUserGames }}</div>
        <div class="text-xs text-slate-400 uppercase font-semibold">Jeux ajoutés</div>
    </div>
</div>

<!-- Top 10 jeux les plus populaires -->
<div class="glass p-6 mb-6">
    <h2 class="text-xl font-bold mb-5 flex items-center gap-2">
        <i data-lucide="trending-up" class="w-6 h-6 text-indigo-500"></i>
        Top 10 des jeux les plus populaires
    </h2>
    
    {% if topGames|length > 0 %}
        <div class="flex flex-col gap-3">
            {% set maxCount = topGames|first %}
            {% for gameName, count in topGames %}
                <div>
                    <div class="flex justify-between mb-1.5">
                        <span class="font-semibold text-slate-100">{{ loop.index }}. {{ gameName }}</span>
                        <span class="font-bold text-indigo-400">{{ count }} joueur{% if count > 1 %}s{% endif %}</span>
                    </div>
                    <div class="bg-slate-800/60 h-2 rounded-full overflow-hidden">
                        <div class="bg-gradient-to-r from-indigo-500 to-violet-500 h-full transition-all duration-500 ease-out" 
                             style="width: {{ (count / maxCount * 100)|round }}%;"></div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-slate-400 text-center py-6">Aucun jeu ajouté pour le moment</p>
    {% endif %}
</div>

<!-- Liens rapides -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
    <a href="{{ path('app_admin_users') }}" class="glass" style="padding: 24px; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 10px 30px rgba(99, 102, 241, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='';">
        <div style="display: flex; align-items: center; gap: 16px;">
            <div style="width: 48px; height: 48px; background: rgba(99, 102, 241, 0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                <i data-lucide="users" style="width: 24px; height: 24px; color: #6366F1;"></i>
            </div>
            <div>
                <div style="font-size: 16px; font-weight: 700; color: #F1F5F9; margin-bottom: 4px;">Gérer les utilisateurs</div>
                <div style="font-size: 12px; color: #94A3B8;">Voir et supprimer des comptes</div>
            </div>
        </div>
    </a>
</div>

{% endblock %}