{% extends 'base_app.html.twig' %}

{% block title %}Rechercher un jeu - Vault.gg{% endblock %}

{% block content %}

<!-- Messages flash -->
{% for label, messages in app.flashes %}
    {% for message in messages %}
        <div style="padding: 16px; border-radius: 8px; margin-bottom: 16px; 
            {% if label == 'success' %}background: rgba(16, 185, 129, 0.2); border: 1px solid rgba(16, 185, 129, 0.3); color: #10B981;{% endif %}
            {% if label == 'error' %}background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.3); color: #EF4444;{% endif %}
            {% if label == 'warning' %}background: rgba(245, 158, 11, 0.2); border: 1px solid rgba(245, 158, 11, 0.3); color: #F59E0B;{% endif %}">
            {{ message }}
        </div>
    {% endfor %}
{% endfor %}

<div style="margin-bottom: 24px;">
    <h1 style="font-size: 32px; font-weight: 900; margin-bottom: 8px;">üîç Rechercher un jeu</h1>
    <p style="color: #94A3B8;">Trouvez des jeux √† ajouter √† votre biblioth√®que</p>
</div>

<!-- Formulaire de recherche -->
<div class="glass" style="padding: 24px; margin-bottom: 24px;">
    <form method="get" action="{{ path('app_search') }}">
        <div style="display: flex; gap: 12px;">git add .env .gitignore composer.json composer.lock symfony.lock
            <input 
                type="text" 
                name="q" 
                value="{{ query }}" 
                placeholder="Nom du jeu (ex: Elden Ring, GTA, Zelda...)"
                style="flex: 1; background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 8px; padding: 12px 16px; color: #F1F5F9;"
                required
            >
            <button 
                type="submit"
                style="background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%); color: white; padding: 12px 32px; border-radius: 8px; font-weight: 600; border: none; cursor: pointer;"
            >
                Rechercher
            </button>
        </div>
    </form>
</div>

<!-- R√©sultats -->
{% if query %}
    <div style="margin-bottom: 16px;">
        <h2 style="font-size: 20px; font-weight: 700; color: #F1F5F9;">
            R√©sultats pour "{{ query }}" ({{ results|length }} jeu(x) trouv√©(s))
        </h2>
    </div>

    {% if results|length > 0 %}
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
            {% for game in results %}
                <div class="glass" style="padding: 16px; transition: all 0.3s ease;">
                    <!-- Image du jeu -->
                    {% if game.background_image %}
                        <img 
                            src="{{ game.background_image }}" 
                            alt="{{ game.name }}"
                            style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;"
                        >
                    {% else %}
                        <div style="width: 100%; height: 150px; background: rgba(99, 102, 241, 0.2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 12px;">
                            <span style="font-size: 48px;">üéÆ</span>
                        </div>
                    {% endif %}

                    <!-- Titre -->
                    <h3 style="font-size: 16px; font-weight: 700; color: #F1F5F9; margin-bottom: 8px;">
                        {{ game.name }}
                    </h3>

                    <!-- Note -->
                    {% if game.rating %}
                        <div style="margin-bottom: 8px;">
                            <span style="background: rgba(245, 158, 11, 0.2); color: #F59E0B; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">
                                ‚≠ê {{ game.rating }}/5
                            </span>
                        </div>
                    {% endif %}

                    <!-- Date de sortie -->
                    {% if game.released %}
                        <p style="color: #94A3B8; font-size: 12px; margin-bottom: 12px;">
                            üìÖ {{ game.released }}
                        </p>
                    {% endif %}

                    <!-- Bouton Ajouter -->
                <form method="post" action="{{ path('app_search_add', {'rawgId': game.id}) }}" style="margin: 0;">
                    <button 
                    type="submit"
                    style="width: 100%; background: rgba(99, 102, 241, 0.2); color: #6366F1; padding: 8px; border-radius: 6px; border: 1px solid rgba(99, 102, 241, 0.3); cursor: pointer; font-weight: 600; transition: all 0.3s ease;"
                    onmouseover="this.style.background='rgba(99, 102, 241, 0.3)'"
                    onmouseout="this.style.background='rgba(99, 102, 241, 0.2)'"
                    >
                    ‚ûï Ajouter √† ma biblioth√®que
                    </button>
                </form>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="glass" style="padding: 48px; text-align: center;">
            <p style="color: #94A3B8; font-size: 18px;">
                Aucun jeu trouv√© pour "{{ query }}" üòï
            </p>
        </div>
    {% endif %}
{% endif %}

{% endblock %}